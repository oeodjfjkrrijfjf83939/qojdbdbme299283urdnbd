<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Digital QR Code</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
</head>

<body>
  <!-- Fixed QR Code Button (Top Right) -->
  <button id="showQRButton" class="show-qr-button-fixed" onclick="showUserQRCode()" title="Show QR Code">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="3" y="3" width="7" height="7"></rect>
      <rect x="14" y="3" width="7" height="7"></rect>
      <rect x="14" y="14" width="7" height="7"></rect>
      <rect x="3" y="14" width="7" height="7"></rect>
    </svg>
  </button>

  <div class="profile-card">
    <h1 id="name">Loading...</h1>
    <p id="username"></p>
    <div id="links" class="links"></div>

    <!-- MultiLynk QR Footer -->
    <div class="multilynk-footer">
      Want your own MultiLynk QR?
      <a href="tel:+917036412617" class="footer-icon-link" title="Call us">
        <img src="./assets/icons/phone.svg" alt="Call" onerror="this.src='./assets/icons/default.svg'">
      </a>
      <a href="mailto:multilynkqr@gmail.com" class="footer-icon-link" title="Email us">
        <img src="./assets/icons/email.svg" alt="Email" onerror="this.src='./assets/icons/default.svg'">
      </a>
      <a href="https://wa.me/917036412617" target="_blank" rel="noopener" class="footer-icon-link" title="WhatsApp us">
        <img src="./assets/icons/whatsapp.svg" alt="WhatsApp" onerror="this.src='./assets/icons/default.svg'">
      </a>
    </div>
    <!-- MultiLynk QR Footer Part is this -->

  </div>

  <!-- UPI Selection Overlay -->
  <div id="upiOverlay" class="upi-overlay">
    <div class="upi-overlay-content">
      <div class="upi-overlay-header">
        <h3 id="upiOverlayTitle">Select UPI ID</h3>
        <button class="upi-close-btn" onclick="closeUPIOverlay()">&times;</button>
      </div>
      <div class="upi-options" id="upiOptions">
        <!-- UPI options will be populated here -->
      </div>
    </div>
  </div>

  <!-- Phone Selection Overlay -->
  <div id="phoneOverlay" class="upi-overlay">
    <div class="upi-overlay-content">
      <div class="upi-overlay-header">
        <h3 id="phoneOverlayTitle">Select Phone Number</h3>
        <button class="upi-close-btn" onclick="closePhoneOverlay()">&times;</button>
      </div>
      <div class="upi-options" id="phoneOptions">
        <!-- Phone options will be populated here -->
      </div>
    </div>
  </div>

  <!-- Email Selection Overlay -->
  <div id="emailOverlay" class="upi-overlay">
    <div class="upi-overlay-content">
      <div class="upi-overlay-header">
        <h3 id="emailOverlayTitle">Select Email Address</h3>
        <button class="upi-close-btn" onclick="closeEmailOverlay()">&times;</button>
      </div>
      <div class="upi-options" id="emailOptions">
        <!-- Email options will be populated here -->
      </div>
    </div>
  </div>

  <!-- Google Maps Selection Overlay -->
  <div id="gmapsOverlay" class="upi-overlay">
    <div class="upi-overlay-content">
      <div class="upi-overlay-header">
        <h3 id="gmapsOverlayTitle">Select Google Maps Option</h3>
        <button class="upi-close-btn" onclick="closeGmapsOverlay()">&times;</button>
      </div>
      <div class="upi-options" id="gmapsOptions">
        <!-- Google Maps options will be populated here -->
      </div>
    </div>
  </div>

  <!-- WhatsApp Selection Overlay -->
  <div id="whatsappOverlay" class="upi-overlay">
    <div class="upi-overlay-content">
      <div class="upi-overlay-header">
        <h3 id="whatsappOverlayTitle">Select WhatsApp Number</h3>
        <button class="upi-close-btn" onclick="closeWhatsAppOverlay()">&times;</button>
      </div>
      <div class="upi-options" id="whatsappOptions">
        <!-- WhatsApp options will be populated here -->
      </div>
    </div>
  </div>

  <!-- QR Code Display Overlay -->
  <div id="qrCodeOverlay" class="upi-overlay">
    <div class="upi-overlay-content" style="max-width: 700px;">
      <div class="upi-overlay-header">
        <h3 id="qrCodeTitle">Scan QR Code</h3>
        <button class="upi-close-btn" onclick="closeQRCodeOverlay()">&times;</button>
      </div>
      <div style="padding: 1px; text-align: center;">
        <div id="qrCodeContainer" style="display: flex; justify-content: center; margin-bottom: 20px;">
          <!-- QR code will be displayed here -->
        </div>
        <p style="color: #666; font-size: 14px; margin-top: 1px;">Scan this QR code to share this profile</p>
      </div>
    </div>
  </div>

  <script>
    // Complete platform configuration with 50+ platforms
    const platformConfig = {
      // Professional & Business Networks
      linkedin: { icon: 'linkedin', label: 'LinkedIn', color: '#0077B5' },
      xing: { icon: 'xing', label: 'Xing', color: '#006567' },
      angellist: { icon: 'angellist', label: 'AngelList', color: '#000000' },
      meetup: { icon: 'meetup', label: 'Meetup', color: '#ED1C40' },
      opportunity: { icon: 'opportunity', label: 'Opportunity', color: '#4A90E2' },

      // Creative & Design Portfolios
      behance: { icon: 'behance', label: 'Behance', color: '#1769FF' },
      dribbble: { icon: 'dribbble', label: 'Dribbble', color: '#EA4C89' },
      figma: { icon: 'figma', label: 'Figma', color: '#F24E1E' },
      portfolio: { icon: 'portfolio', label: 'Portfolio', color: '#1473E6' },
      artstation: { icon: 'artstation', label: 'ArtStation', color: '#13AFF0' },
      zerply: { icon: 'zerply', label: 'Zerply', color: '#9DBC7A' },

      // Social Media Platforms
      instagram: { icon: 'instagram', label: 'Instagram', color: '#E4405F' },
      twitter: { icon: 'twitter', label: 'Twitter', color: '#1DA1F2' },
      facebook: { icon: 'facebook', label: 'Facebook', color: '#1877F2' },
      threads: { icon: 'threads', label: 'Threads', color: '#000000' },
      mastodon: { icon: 'mastodon', label: 'Mastodon', color: '#6364FF' },
      bluesky: { icon: 'bluesky', label: 'BlueSky', color: '#1285FE' },

      // Video Platforms
      youtube: { icon: 'youtube', label: 'YouTube', color: '#FF0000' },
      tiktok: { icon: 'tiktok', label: 'TikTok', color: '#000000' },
      vimeo: { icon: 'vimeo', label: 'Vimeo', color: '#1AB7EA' },
      twitch: { icon: 'twitch', label: 'Twitch', color: '#9146FF' },
      rumble: { icon: 'rumble', label: 'Rumble', color: '#85C742' },
      dailymotion: { icon: 'dailymotion', label: 'Dailymotion', color: '#0066DC' },

      // Music & Audio Platforms
      spotify: { icon: 'spotify', label: 'Spotify', color: '#1DB954' },
      soundcloud: { icon: 'soundcloud', label: 'SoundCloud', color: '#FF5500' },
      applemusic: { icon: 'applemusic', label: 'Apple Music', color: '#FA243C' },
      bandcamp: { icon: 'bandcamp', label: 'Bandcamp', color: '#1DA0C3' },

      // Developer & Tech Communities
      github: { icon: 'github', label: 'GitHub', color: '#181717' },
      gitlab: { icon: 'gitlab', label: 'GitLab', color: '#FC6D26' },
      bitbucket: { icon: 'bitbucket', label: 'Bitbucket', color: '#0052CC' },
      stackoverflow: { icon: 'stackoverflow', label: 'Stack Overflow', color: '#F58025' },
      devto: { icon: 'devto', label: 'Dev.to', color: '#0A0A0A' },
      codepen: { icon: 'codepen', label: 'CodePen', color: '#000000' },

      // Messaging & Communication
      whatsapp: { icon: 'whatsapp', label: 'WhatsApp', color: '#25D366', isWhatsApp: true },
      telegram: { icon: 'telegram', label: 'Telegram', color: '#26A5E4' },
      discord: { icon: 'discord', label: 'Discord', color: '#5865F2' },
      signal: { icon: 'signal', label: 'Signal', color: '#3A76F0' },
      skype: { icon: 'skype', label: 'Skype', color: '#00AFF0' },
      slack: { icon: 'slack', label: 'Slack', color: '#4A154B' },
      wechat: { icon: 'wechat', label: 'WeChat', color: '#09B83E' },
      line: { icon: 'line', label: 'LINE', color: '#00B900' },
      viber: { icon: 'viber', label: 'Viber', color: '#7360F2' },
      messenger: { icon: 'messenger', label: 'Messenger', color: '#0084FF' },

      // Gaming Platforms
      steam: { icon: 'steam', label: 'Steam', color: '#171A21' },
      xbox: { icon: 'xbox', label: 'Xbox', color: '#107C10' },
      playstation: { icon: 'playstation', label: 'PlayStation', color: '#003087' },
      nintendo: { icon: 'nintendo', label: 'Nintendo', color: '#E60012' },
      dream11: { icon: 'dream11', label: 'Dream11', color: '#FF6B6B' },
      mpl: { icon: 'mpl', label: 'MPL', color: '#FF6B35' },
      winzo: { icon: 'winzo', label: 'WinZO', color: '#FF4757' },

      // Creator & Monetization
      patreon: { icon: 'patreon', label: 'Patreon', color: '#FF424D' },
      kofi: { icon: 'kofi', label: 'Ko-fi', color: '#FF5E5B' },
      buymeacoffee: { icon: 'buymeacoffee', label: 'Buy Me a Coffee', color: '#FFDD00' },
      substack: { icon: 'substack', label: 'Substack', color: '#FF6719' },

      // E-commerce & Shopping
      etsy: { icon: 'etsy', label: 'Etsy', color: '#F16521' },
      amazon: { icon: 'amazon', label: 'Amazon', color: '#FF9900' },
      shopify: { icon: 'shopify', label: 'Shopify', color: '#96BF48' },
      flipkart: { icon: 'flipkart', label: 'Flipkart', color: '#FF9900' },
      myntra: { icon: 'myntra', label: 'Myntra', color: '#FF3F6C' },
      meesho: { icon: 'meesho', label: 'Meesho', color: '#8B1874' },
      nykaa: { icon: 'nykaa', label: 'Nykaa', color: '#FC2779' },
      bigbasket: { icon: 'bigbasket', label: 'BigBasket', color: '#84C225' },
      blinkit: { icon: 'blinkit', label: 'Blinkit', color: '#F8CB46' },
      zepto: { icon: 'zepto', label: 'Zepto', color: '#8B5CF6' },

      // Photography & Visual Arts
      flickr: { icon: 'flickr', label: 'Flickr', color: '#0063DC' },
      '500px': { icon: '500px', label: '500px', color: '#0099E5' },
      unsplash: { icon: 'unsplash', label: 'Unsplash', color: '#000000' },

      // Blogging & Writing
      medium: { icon: 'medium', label: 'Medium', color: '#000000' },
      wordpress: { icon: 'wordpress', label: 'WordPress', color: '#21759B' },
      blogger: { icon: 'blogger', label: 'Blogger', color: '#FF5722' },

      // Other Social Platforms
      pinterest: { icon: 'pinterest', label: 'Pinterest', color: '#E60023' },
      reddit: { icon: 'reddit', label: 'Reddit', color: '#FF4500' },
      snapchat: { icon: 'snapchat', label: 'Snapchat', color: '#FFFC00' },
      tumblr: { icon: 'tumblr', label: 'Tumblr', color: '#36465D' },
      bereal: { icon: 'bereal', label: 'BeReal', color: '#000000' },
      clubhouse: { icon: 'clubhouse', label: 'Clubhouse', color: '#FF6B35' },
      nextdoor: { icon: 'nextdoor', label: 'Nextdoor', color: '#00B04F' },
      strava: { icon: 'strava', label: 'Strava', color: '#FC4C02' },
      vk: { icon: 'vk', label: 'VK', color: '#4680C2' },
      ok: { icon: 'ok', label: 'OK.ru', color: '#EE8208' },
      kakaotalk: { icon: 'kakaotalk', label: 'Kakao Talk', color: '#FFE812' },
      quora: { icon: 'quora', label: 'Quora', color: '#B92B27' },

      // Indian Social Platforms
      sharechat: { icon: 'sharechat', label: 'ShareChat', color: '#4A90E2' },
      moj: { icon: 'moj', label: 'Moj', color: '#FF6B6B' },
      josh: { icon: 'josh', label: 'Josh', color: '#FF4757' },
      koo: { icon: 'koo', label: 'Koo', color: '#FFCC00' },
      mxtakatak: { icon: 'mxtakatak', label: 'MX TakaTak', color: '#0F0F0F' },

      // Productivity & Tools
      linktree: { icon: 'linktree', label: 'Linktree', color: '#39E09B' },
      notion: { icon: 'notion', label: 'Notion', color: '#000000' },
      calendly: { icon: 'calendly', label: 'Calendly', color: '#006BFF' },

      // Payment & Donation Platforms
      paypal: { icon: 'paypal', label: 'PayPal', color: '#0070BA' },
      gpay: { icon: 'gpay', label: 'Google Pay', color: '#4285F4', isUPI: true },
      phonepe: { icon: 'phonepe', label: 'PhonePe', color: '#5F259F', isUPI: true },
      paytm: { icon: 'paytm', label: 'PayTM', color: '#00BAF2', isUPI: true },
      upi: { icon: 'upi', label: 'UPI', color: '#00BAF2', isUPI: true },
      cashapp: { icon: 'cashapp', label: 'Cash App', color: '#00D632' },
      razorpay: { icon: 'razorpay', label: 'Razorpay', color: '#0C2451' },
      cred: { icon: 'cred', label: 'CRED', color: '#000000' },
      mobikwik: { icon: 'mobikwik', label: 'MobiKwik', color: '#D91E36' },
      freecharge: { icon: 'freecharge', label: 'Freecharge', color: '#F7C50E' },
      bhim: { icon: 'bhim', label: 'BHIM', color: '#097FD9' },
      amazonpay: { icon: 'amazonpay', label: 'Amazon Pay', color: '#FF9900' },
      navi: { icon: 'navi', label: 'Navi', color: '#0066FF' },
      jupiter: { icon: 'jupiter', label: 'Jupiter', color: '#6C5CE7' },
      jiofinance: { icon: 'jiofinance', label: 'JioFinance', color: '#0A7CFF' },

      // Business & Professional Tools
      crunchbase: { icon: 'crunchbase', label: 'Crunchbase', color: '#0288D1' },
      glassdoor: { icon: 'glassdoor', label: 'Glassdoor', color: '#0CAA41' },
      indeed: { icon: 'indeed', label: 'Indeed', color: '#2164F3' },
      naukri: { icon: 'naukri', label: 'Naukri', color: '#4A90E2' },

      // Education & Learning
      coursera: { icon: 'coursera', label: 'Coursera', color: '#0056D3' },
      udemy: { icon: 'udemy', label: 'Udemy', color: '#A435F0' },
      skillshare: { icon: 'skillshare', label: 'Skillshare', color: '#00FF88' },
      khanacademy: { icon: 'khanacademy', label: 'Khan Academy', color: '#14BF96' },
      byjus: { icon: 'byjus', label: "BYJU'S", color: '#8B1874' },
      unacademy: { icon: 'unacademy', label: 'Unacademy', color: '#08BD80' },
      vedantu: { icon: 'vedantu', label: 'Vedantu', color: '#9333EA' },
      upgrad: { icon: 'upgrad', label: 'upGrad', color: '#1E40AF' },
      physicswallah: { icon: 'physicswallah', label: 'PhysicsWallah', color: '#FF6B35' },

      // App Downloads
      playstore: { icon: 'playstore', label: 'Google Play Store', color: '#00D632' },
      appstore: { icon: 'appstore', label: 'App Store', color: '#0066CC' },

      // Business Services & Pricing
      pricelist: { icon: 'price-list', label: 'Price List / Service Menu', color: '#6366F1' },

      // Booking & Actions
      bookingpage: { icon: 'booking', label: 'Booking Page', color: '#10B981' },
      appointment: { icon: 'appointment', label: 'Appointment', color: '#8B5CF6' },
      buytickets: { icon: 'ticket', label: 'Buy Tickets', color: '#F59E0B' },
      reservation: { icon: 'reservation', label: 'Reservation', color: '#EC4899' },
      registration: { icon: 'registration', label: 'Registration', color: '#3B82F6' },
      consultation: { icon: 'consultation', label: 'Consultation', color: '#14B8A6' },

      // Food & Dining
      swiggy: { icon: 'swiggy', label: 'Swiggy', color: '#FC8019' },
      zomato: { icon: 'zomato', label: 'Zomato', color: '#E23744' },
      dineout: { icon: 'dineout', label: 'Dineout', color: '#FF6B6B' },
      eatsure: { icon: 'eatsure', label: 'EatSure', color: '#FF4757' },
      magicpin: { icon: 'magicpin', label: 'Magicpin', color: '#FF6B35' },
      jiomart: { icon: 'jiomart', label: 'JioMart', color: '#0A7CFF' },
      swiggyinstamart: { icon: 'swiggyinstamart', label: 'Swiggy Instamart', color: '#FC8019' },
      dunzo: { icon: 'dunzo', label: 'Dunzo', color: '#E52B50' },
      menucard: { icon: 'menu-card', label: 'Menu Card', color: '#FF6B35' },

      // Ride & Transportation
      ola: { icon: 'ola', label: 'Ola', color: '#00D632' },
      uber: { icon: 'uber', label: 'Uber', color: '#000000' },
      rapido: { icon: 'rapido', label: 'Rapido', color: '#FFD700' },
      porter: { icon: 'porter', label: 'Porter', color: '#FF6B35' },

      // Travel & Hospitality
      makemytrip: { icon: 'makemytrip', label: 'MakeMyTrip', color: '#E7352B' },
      goibibo: { icon: 'goibibo', label: 'Goibibo', color: '#FF6B35' },
      oyo: { icon: 'oyo', label: 'OYO', color: '#EE2E24' },
      cleartrip: { icon: 'cleartrip', label: 'Cleartrip', color: '#FF4757' },
      ixigo: { icon: 'ixigo', label: 'Ixigo', color: '#EC5B24' },

      // Health & Wellness
      practo: { icon: 'practo', label: 'Practo', color: '#1C8B62' },
      onemg: { icon: 'onemg', label: '1mg', color: '#FF6F61' },
      pharmeasy: { icon: 'pharmeasy', label: 'PharmEasy', color: '#10847E' },
      cultfit: { icon: 'cultfit', label: 'Cult.fit', color: '#FF6B35' },

      // Books & Reading
      goodreads: { icon: 'goodreads', label: 'Goodreads', color: '#553B08' },

      // Film & TV
      imdb: { icon: 'imdb', label: 'IMDb', color: '#F5C518' },

      // Entertainment & OTT
      jiocinema: { icon: 'jiocinema', label: 'JioCinema', color: '#8B1874' },
      hotstar: { icon: 'hotstar', label: 'Hotstar', color: '#1F1F1F' },
      netflix: { icon: 'netflix', label: 'Netflix', color: '#E50914' },
      primevideo: { icon: 'primevideo', label: 'Prime Video', color: '#00A8E1' },
      sonyliv: { icon: 'sonyliv', label: 'Sony LIV', color: '#F47920' },
      zee5: { icon: 'zee5', label: 'ZEE5', color: '#8B1874' },
      mxplayer: { icon: 'mxplayer', label: 'MX Player', color: '#0F0F0F' },

      // Contact
      email: { icon: 'email', label: 'Email', color: '#667eea', isEmail: true },
      phone: { icon: 'phone', label: 'Phone', color: '#667eea', isTel: true },
      website: { icon: 'website', label: 'Website', color: '#667eea' },
      businesscard: { icon: 'business-card', label: 'Business Card', color: '#667eea' },
      location: { icon: 'gmaps', label: 'Location', color: '#4285F4', isGmaps: true },
      googleReview: { icon: 'gmaps', label: 'Google Review', color: '#4285F4', isGmaps: true }
    };

    async function loadUser() {
      const params = new URLSearchParams(window.location.search);
      const username = params.get('u');
      const userCode = params.get('code');

      if (!username) {
        document.body.innerHTML = `
          <div class='profile-card'>
            <h2>üîí Access Denied</h2>
            <p style='font-size: 16px; color: #666; margin: 20px 0;'>Invalid link or QR code.<br> Please re-scan the correct QR code.</p>
            
            <div style='background: #f8d7da; padding: 20px; border-radius: 12px; margin: 20px 0;'>
              <p style='color: #555; margin: 5px 0;'><strong>‚ùå Not Found</strong></p>
              <p style='color: #555; margin: 5px 0;'>Profile doesn't exist or credentials don't match.</p>
            </div>
            
            <div style='background: #e8f4f8; padding: 20px; border-radius: 12px; margin: 20px 0;'>
              <p style='color: #555; margin: 5px 0;'><strong>üí° What to do:</strong></p>
              <p style='color: #555; margin: 5px 0;'>‚Ä¢ Scan the QR code again ‚Ä¢</p>
              <p style='color: #555; margin: 5px 0;'>‚Ä¢ Request a new / updated QR ‚Ä¢</p>
            </div>

            <!-- MultiLynk QR Footer -->
            <div class='multilynk-footer'>
              Want your own MultiLynk QR?
              <a href='tel:+917036412617' class='footer-icon-link' title='Call us'>
                <img src='./assets/icons/phone.svg' alt='Call' onerror="this.src='./assets/icons/default.svg'">
              </a>
              <a href='mailto:multilynkqr@gmail.com' class='footer-icon-link' title='Email us'>
                <img src='./assets/icons/email.svg' alt='Email' onerror="this.src='./assets/icons/default.svg'">
              </a>
              <a href='https://wa.me/917036412617' target='_blank' rel='noopener' class='footer-icon-link' title='WhatsApp us'>
                <img src='./assets/icons/whatsapp.svg' alt='WhatsApp' onerror="this.src='./assets/icons/default.svg'">
              </a>
            </div>
          </div>
        `;
        return;
      }

      if (!userCode) {
        document.body.innerHTML = `
          <div class='profile-card'>
            <h2>üîí Access Denied</h2>
            <p style='font-size: 16px; color: #666; margin: 20px 0;'>Invalid link or QR code.<br> Please re-scan the correct QR code.</p>
            
            <div style='background: #f8d7da; padding: 20px; border-radius: 12px; margin: 20px 0;'>
              <p style='color: #555; margin: 5px 0;'><strong>‚ùå Not Found</strong></p>
              <p style='color: #555; margin: 5px 0;'>Profile doesn't exist or credentials don't match.</p>
            </div>
            
            <div style='background: #e8f4f8; padding: 20px; border-radius: 12px; margin: 20px 0;'>
              <p style='color: #555; margin: 5px 0;'><strong>üí° What to do:</strong></p>
              <p style='color: #555; margin: 5px 0;'>‚Ä¢ Scan the QR code again ‚Ä¢</p>
              <p style='color: #555; margin: 5px 0;'>‚Ä¢ Request a new / updated QR ‚Ä¢</p>
            </div>

            <!-- MultiLynk QR Footer -->
            <div class='multilynk-footer'>
              Want your own MultiLynk QR?
              <a href='tel:+917036412617' class='footer-icon-link' title='Call us'>
                <img src='./assets/icons/phone.svg' alt='Call' onerror="this.src='./assets/icons/default.svg'">
              </a>
              <a href='mailto:multilynkqr@gmail.com' class='footer-icon-link' title='Email us'>
                <img src='./assets/icons/email.svg' alt='Email' onerror="this.src='./assets/icons/default.svg'">
              </a>
              <a href='https://wa.me/917036412617' target='_blank' rel='noopener' class='footer-icon-link' title='WhatsApp us'>
                <img src='./assets/icons/whatsapp.svg' alt='WhatsApp' onerror="this.src='./assets/icons/default.svg'">
              </a>
            </div>
          </div>
        `;
        return;
      }

      try {
        let user = null;

        // First, load the index to find the correct data file
        try {
          const indexRes = await fetch('./data/index.json');

          if (indexRes.ok) {
            const index = await indexRes.json();
            const dataFile = index[userCode];

            if (dataFile) {
              // Found the data file path in index
              const dataFilePath = `./data/${dataFile}`;
              console.log(`üìã Index lookup: ${userCode} ‚Üí ${dataFile}`);

              try {
                const res = await fetch(dataFilePath);
                if (res.ok) {
                  const users = await res.json();
                  user = users.find(u => u.username === username && u.userCode === userCode);
                  if (user) {
                    console.log(`‚úÖ Found user in ${dataFile}`);
                  }
                }
              } catch (fileErr) {
                console.log(`‚ö†Ô∏è Error loading ${dataFile}:`, fileErr.message);
              }
            } else {
              console.log(`‚ö†Ô∏è UserCode ${userCode} not found in index`);
            }
          } else {
            console.log('‚ö†Ô∏è Index file not found, falling back to sequential search');
            // Fallback: search all files if index doesn't exist
            const dataFiles = DATA_FILES_CONFIG.files;

            for (const file of dataFiles) {
              try {
                const res = await fetch(file);
                if (res.ok) {
                  const users = await res.json();
                  user = users.find(u => u.username === username && u.userCode === userCode);
                  if (user) {
                    console.log(`‚úÖ Found user in ${file} (fallback)`);
                    break;
                  }
                }
              } catch (fileErr) {
                console.log(`‚ö†Ô∏è Error searching ${file}:`, fileErr.message);
              }
            }
          }
        } catch (indexErr) {
          console.log('‚ö†Ô∏è Error loading index, falling back to sequential search:', indexErr.message);
          // Fallback: search all files if index loading fails
          const dataFiles = DATA_FILES_CONFIG.files;

          for (const file of dataFiles) {
            try {
              const res = await fetch(file);
              if (res.ok) {
                const users = await res.json();
                user = users.find(u => u.username === username && u.userCode === userCode);
                if (user) {
                  console.log(`‚úÖ Found user in ${file} (fallback)`);
                  break;
                }
              }
            } catch (fileErr) {
              console.log(`‚ö†Ô∏è Error searching ${file}:`, fileErr.message);
            }
          }
        }

        if (!user) {
          document.body.innerHTML = `
            <div class='profile-card'>
              <h2>üîí Access Denied</h2>
              <p style='font-size: 16px; color: #666; margin: 20px 0;'>Invalid link or QR code.<br> Please re-scan the correct QR code.</p>
              
              <div style='background: #f8d7da; padding: 20px; border-radius: 12px; margin: 20px 0;'>
                <p style='color: #555; margin: 5px 0;'><strong>‚ùå Not Found</strong></p>
                <p style='color: #555; margin: 5px 0;'>Profile doesn't exist or credentials don't match.</p>
              </div>
              
              <div style='background: #e8f4f8; padding: 20px; border-radius: 12px; margin: 20px 0;'>
                <p style='color: #555; margin: 5px 0;'><strong>üí° What to do:</strong></p>
                <p style='color: #555; margin: 5px 0;'>‚Ä¢ Scan the QR code again ‚Ä¢</p>
                <p style='color: #555; margin: 5px 0;'>‚Ä¢ Request a new / updated QR ‚Ä¢</p>
              </div>

              <!-- MultiLynk QR Footer -->
              <div class='multilynk-footer'>
                Want your own MultiLynk QR?
                <a href='tel:+917036412617' class='footer-icon-link' title='Call us'>
                  <img src='./assets/icons/phone.svg' alt='Call' onerror="this.src='./assets/icons/default.svg'">
                </a>
                <a href='mailto:multilynkqr@gmail.com' class='footer-icon-link' title='Email us'>
                  <img src='./assets/icons/email.svg' alt='Email' onerror="this.src='./assets/icons/default.svg'">
                </a>
                <a href='https://wa.me/917036412617' target='_blank' rel='noopener' class='footer-icon-link' title='WhatsApp us'>
                  <img src='./assets/icons/whatsapp.svg' alt='WhatsApp' onerror="this.src='./assets/icons/default.svg'">
                </a>
              </div>
            </div>
          `;
          return;
        }

        // Sanitize user input to prevent XSS
        function sanitizeInput(input) {
          if (typeof input !== 'string') return '';
          // No escaping needed - innerText automatically treats content as plain text
          // This prevents XSS while allowing all characters to display correctly
          return input;
        }

        const sanitizedName = sanitizeInput(user.fullname);
        const sanitizedUsername = sanitizeInput(user.username);
        const sanitizedDescription = sanitizeInput(user.publicDescription || '');

        document.title = sanitizedName;
        document.getElementById("name").innerText = sanitizedName;

        // Display public description if available, otherwise show @username
        if (sanitizedDescription && sanitizedDescription.trim()) {
          document.getElementById("username").innerText = sanitizedDescription;
        } else {
          document.getElementById("username").innerText = "@" + sanitizedUsername;
        }


        const linksDiv = document.getElementById("links");
        linksDiv.innerHTML = "";

        let linkCount = 0;

        // Define platform categories
        const platformCategories = {
          'üíº Professional': ['linkedin', 'xing', 'angellist', 'crunchbase', 'glassdoor', 'indeed', 'naukri', 'meetup', 'opportunity'],
          'üé® Design & Creative': ['behance', 'dribbble', 'figma', 'portfolio', 'artstation', 'zerply'],
          'üì± Social Media': ['instagram', 'twitter', 'facebook', 'threads', 'mastodon', 'bluesky'],
          'üé• Video & Streaming': ['youtube', 'tiktok', 'vimeo', 'twitch', 'rumble', 'dailymotion'],
          'üéµ Music & Audio': ['spotify', 'soundcloud', 'applemusic', 'bandcamp'],
          'üíª Developer & Tech': ['github', 'gitlab', 'bitbucket', 'stackoverflow', 'devto', 'codepen'],
          'üí¨ Messaging & Chat': ['whatsapp', 'telegram', 'discord', 'signal', 'skype', 'slack', 'wechat', 'line', 'viber', 'messenger'],
          'üéÆ Gaming': ['steam', 'xbox', 'playstation', 'nintendo', 'dream11', 'mpl', 'winzo'],
          'üí∞ Creator & Monetization': ['patreon', 'kofi', 'buymeacoffee', 'substack'],
          'üõí E-commerce & Shopping': ['etsy', 'amazon', 'shopify', 'flipkart', 'myntra', 'meesho', 'nykaa', 'bigbasket', 'blinkit', 'zepto'],
          'üì∏ Photography & Visual': ['flickr', '500px', 'unsplash'],
          '‚úçÔ∏è Blogging & Writing': ['medium', 'wordpress', 'blogger'],
          'üåê Other Social': ['pinterest', 'reddit', 'snapchat', 'tumblr', 'bereal', 'clubhouse', 'nextdoor', 'strava', 'sharechat', 'moj', 'josh', 'koo', 'mxtakatak', 'vk', 'ok', 'kakaotalk', 'quora'],
          'üîß Productivity & Tools': ['linktree', 'notion', 'calendly'],
          'üí≥ Payment & Donation': ['paypal', 'gpay', 'phonepe', 'paytm', 'upi', 'cashapp', 'razorpay', 'cred', 'mobikwik', 'freecharge', 'bhim', 'amazonpay', 'navi', 'jupiter', 'jiofinance'],
          'üéì Education & Learning': ['coursera', 'udemy', 'skillshare', 'khanacademy', 'byjus', 'unacademy', 'vedantu', 'upgrad', 'physicswallah'],
          'üì± App Downloads': ['playstore', 'appstore'],
          'üíº Business Services & Pricing': ['pricelist'],
          'üìÖ Booking & Actions': ['bookingpage', 'appointment', 'buytickets', 'reservation', 'registration', 'consultation'],
          'üçî Food & Dining': ['swiggy', 'zomato', 'dineout', 'eatsure', 'magicpin', 'jiomart', 'swiggyinstamart', 'dunzo', 'menucard'],
          'üöó Ride & Transportation': ['ola', 'uber', 'rapido', 'porter'],
          '‚úàÔ∏è Travel & Hospitality': ['makemytrip', 'goibibo', 'oyo', 'cleartrip', 'ixigo'],
          'üè• Health & Wellness': ['practo', 'onemg', 'pharmeasy', 'cultfit'],
          'üìö Books & Reading': ['goodreads'],
          'üé¨ Entertainment & OTT': ['jiocinema', 'hotstar', 'netflix', 'primevideo', 'sonyliv', 'zee5', 'mxplayer', 'imdb'],
          'üìû Contact': ['email', 'phone', 'website', 'businesscard', 'location', 'googleReview']
        };

        // Create categorized links
        Object.entries(platformCategories).forEach(([categoryName, platforms]) => {
          const categoryLinks = [];

          // Insert certificates before Contact section
          if (categoryName === 'üìû Contact' && user.certificates && Array.isArray(user.certificates) && user.certificates.length > 0) {
            const certSection = document.createElement('div');
            certSection.className = 'category-section';
            certSection.innerHTML = `
              <h3 class="category-title">üéì Certificates & Credentials</h3>
              <div class="category-links">
                ${user.certificates.map(cert => `
                  <a href="${cert.url}" target="_blank" rel="noopener" title="${cert.title}" class="social-link">
                    <img src="./assets/icons/certificate.svg" alt="Certificate" 
                         onerror="this.src='./assets/icons/default.svg'" 
                         style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                    <span class="link-label">${cert.title}</span>
                  </a>
                `).join('')}
              </div>
            `;
            linksDiv.appendChild(certSection);
            linkCount += user.certificates.length;
          }

          platforms.forEach(platform => {
            const config = platformConfig[platform];
            let url = user[platform];

            if (url && url.trim()) {
              linkCount++;

              const iconPath = `./assets/icons/${config.icon}.svg`;

              // Handle different link types
              if (config.isEmail) {
                // Check if there are multiple email addresses (comma-separated)
                const emailAddresses = url.split(',').map(email => email.trim()).filter(email => email);

                if (emailAddresses.length > 1) {
                  // Multiple email addresses - show overlay option
                  categoryLinks.push(`
                    <div class="social-link email-link" onclick="showEmailOverlay('${emailAddresses.join('|')}', '${config.label}')" title="Click to select ${config.label} address">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                      <span class="upi-count-top-right">${emailAddresses.length}</span>
                    </div>
                  `);
                } else {
                  // Single email address - direct mailto
                  url = `mailto:${url}`;
                  categoryLinks.push(`
                    <a href="${url}" target="_blank" rel="noopener" title="${config.label}" class="social-link">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                    </a>
                  `);
                }
                return; // Skip the regular link creation
              } else if (config.isTel) {
                // Check if there are multiple phone numbers (comma-separated)
                const phoneNumbers = url.split(',').map(num => num.trim()).filter(num => num);

                if (phoneNumbers.length > 1) {
                  // Multiple phone numbers - show overlay option
                  categoryLinks.push(`
                    <div class="social-link phone-link" onclick="showPhoneOverlay('${phoneNumbers.join('|')}', '${config.label}')" title="Click to select ${config.label} number">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                      <span class="upi-count-top-right">${phoneNumbers.length}</span>
                    </div>
                  `);
                } else {
                  // Single phone number - direct call
                  url = `tel:${url}`;
                  categoryLinks.push(`
                    <a href="${url}" target="_blank" rel="noopener" title="${config.label}" class="social-link">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                    </a>
                  `);
                }
                return; // Skip the regular link creation
              } else if (config.isGmaps) {
                // Handle Google Maps related links (location and review)
                return; // Skip individual processing, will be handled specially
              } else if (config.isUPI) {
                // Check if there are multiple UPI IDs (comma-separated)
                const upiIds = url.split(',').map(id => id.trim()).filter(id => id);

                if (upiIds.length > 1) {
                  // Multiple UPI IDs - show overlay option
                  categoryLinks.push(`
                    <div class="social-link upi-link" onclick="showUPIOverlay('${upiIds.join('|')}', '${config.label}')" title="Click to select ${config.label} UPI ID">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                      <span class="upi-count-top-right">${upiIds.length}</span>
                    </div>
                  `);
                } else {
                  // Single UPI ID - direct copy
                  categoryLinks.push(`
                    <div class="social-link upi-link" onclick="copyUPI('${url}', '${config.label}')" title="Click to copy ${config.label} UPI ID">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                    </div>
                  `);
                }
                return; // Skip the regular link creation
              } else if (config.isWhatsApp) {
                // Check if there are multiple WhatsApp numbers (comma-separated wa.me URLs)
                const whatsappUrls = url.split(',').map(u => u.trim()).filter(u => u);

                if (whatsappUrls.length > 1) {
                  // Multiple WhatsApp numbers - show overlay option
                  categoryLinks.push(`
                    <div class="social-link whatsapp-link" onclick="showWhatsAppOverlay('${whatsappUrls.join('|')}', '${config.label}')" title="Click to select ${config.label} number">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                      <span class="upi-count-top-right">${whatsappUrls.length}</span>
                    </div>
                  `);
                } else {
                  // Single WhatsApp number - direct link
                  categoryLinks.push(`
                    <a href="${url}" target="_blank" rel="noopener" title="${config.label}" class="social-link">
                      <img src="${iconPath}" alt="${config.label}" 
                           onerror="this.src='./assets/icons/default.svg'" 
                           style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                      <span class="link-label">${config.label}</span>
                    </a>
                  `);
                }
                return; // Skip the regular link creation
              }

              categoryLinks.push(`
                <a href="${url}" target="_blank" rel="noopener" title="${config.label}" class="social-link">
                  <img src="${iconPath}" alt="${config.label}" 
                       onerror="this.src='./assets/icons/default.svg'" 
                       style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                  <span class="link-label">${config.label}</span>
                </a>
              `);
            }
          });

          // Special handling for gmaps (location and review)
          if (categoryName === 'üìû Contact') {
            const locationUrl = user.location;
            const reviewUrl = user.googleReview;

            if (locationUrl && locationUrl.trim()) {
              if (reviewUrl && reviewUrl.trim()) {
                // Both location and review available - show combined option
                const gmapsOptions = [];
                gmapsOptions.push(`Location: ${locationUrl}`);
                gmapsOptions.push(`Google Review: ${reviewUrl}`);

                categoryLinks.push(`
                  <div class="social-link gmaps-link" onclick="showGmapsOverlay('${gmapsOptions.join('|')}', 'Google Maps')" title="Click to select Google Maps option">
                    <img src="./assets/icons/gmaps.svg" alt="Google Maps" 
                         onerror="this.src='./assets/icons/default.svg'" 
                         style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                    <span class="link-label">Google Maps</span>
                    <span class="upi-count-top-right">2</span>
                  </div>
                `);
              } else {
                // Only location available
                categoryLinks.push(`
                  <a href="${locationUrl}" target="_blank" rel="noopener" title="Google Maps Location" class="social-link">
                    <img src="./assets/icons/gmaps.svg" alt="Google Maps" 
                         onerror="this.src='./assets/icons/default.svg'" 
                         style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                    <span class="link-label">Google Maps</span>
                  </a>
                `);
              }
            } else if (reviewUrl && reviewUrl.trim()) {
              // Only review available
              categoryLinks.push(`
                <a href="${reviewUrl}" target="_blank" rel="noopener" title="Google Review" class="social-link">
                  <img src="./assets/icons/gmaps.svg" alt="Google Maps" 
                       onerror="this.src='./assets/icons/default.svg'" 
                       style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                  <span class="link-label">Google Review</span>
                </a>
              `);
            }
          }

          // Render custom links for this category
          const categoryKey = categoryName.replace(/[^\w]/g, '').toLowerCase();
          const categoryMapping = {
            'professional': 'professional',
            'designcreative': 'design',
            'socialmedia': 'social',
            'videostreaming': 'video',
            'musicaudio': 'music',
            'developertech': 'developer',
            'messagingchat': 'messaging',
            'gaming': 'gaming',
            'creatormonetization': 'creator',
            'ecommerceshopping': 'ecommerce',
            'photographyvisual': 'photography',
            'bloggingwriting': 'blogging',
            'othersocial': 'miscSocial',
            'productivitytools': 'productivity',
            'paymentdonation': 'payment',
            'businessprofessionaltools': 'business',
            'educationlearning': 'education',
            'businessservicespricing': 'pricing',
            'bookingactions': 'booking',
            'fooddining': 'food',
            'ridetransportation': 'transportation',
            'travelhospitality': 'travel',
            'healthwellness': 'health',
            'booksreading': 'books',
            'entertainmentott': 'ott',
            'contact': 'contact'
          };

          const mappedCategory = categoryMapping[categoryKey];
          const customKey = `${mappedCategory}Custom`;
          const customLinks = user[customKey];

          if (customLinks && Array.isArray(customLinks) && customLinks.length > 0) {
            customLinks.forEach(link => {
              if (link.title && link.url) {
                categoryLinks.push(`
                  <a href="${link.url}" target="_blank" rel="noopener" title="${link.title}" class="social-link">
                    <img src="./assets/icons/custom.svg" alt="${link.title}" 
                         onerror="this.src='./assets/icons/default.svg'" 
                         style="image-rendering: crisp-edges; -webkit-image-rendering: crisp-edges;">
                    <span class="link-label">${link.title}</span>
                  </a>
                `);
              }
            });
          }

          // Only add category if it has links
          if (categoryLinks.length > 0) {
            linksDiv.innerHTML += `
              <div class="category-section">
                <h3 class="category-title">${categoryName}</h3>
                <div class="category-links">
                  ${categoryLinks.join('')}
                </div>
              </div>
            `;
          }
        });

        if (linkCount === 0) {
          linksDiv.innerHTML = "<p style='color: #999; margin-top: 20px;'>No links added yet</p>";
        }
      } catch (err) {
        document.body.innerHTML = "<div class='profile-card'><h2>‚ùå Error loading user</h2><p>" + err.message + "</p></div>";
      }
    }

    // Copy UPI ID to clipboard
    function copyUPI(upiId, platformName) {
      navigator.clipboard.writeText(upiId).then(() => {
        // Show success message
        const toast = document.createElement('div');
        toast.className = 'upi-toast';
        toast.innerHTML = `‚úÖ ${platformName} UPI ID copied!<br><strong>${upiId}</strong>`;
        document.body.appendChild(toast);

        // Remove toast after 3 seconds
        setTimeout(() => {
          toast.remove();
        }, 3000);
      }).catch(err => {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = upiId;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);

        // Show success message
        const toast = document.createElement('div');
        toast.className = 'upi-toast';
        toast.innerHTML = `‚úÖ ${platformName} UPI ID copied!<br><strong>${upiId}</strong>`;
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.remove();
        }, 3000);
      });
    }

    // Show UPI overlay for multiple IDs
    function showUPIOverlay(upiIdsString, platformName) {
      const upiIds = upiIdsString.split('|').map(id => id.trim()).filter(id => id);
      const overlay = document.getElementById('upiOverlay');
      const title = document.getElementById('upiOverlayTitle');
      const options = document.getElementById('upiOptions');

      title.textContent = `Select ${platformName} UPI ID`;
      options.innerHTML = '';

      upiIds.forEach((upiId, index) => {
        const option = document.createElement('div');
        option.className = 'upi-option';
        option.innerHTML = `
          <div class="upi-option-content">
            <span class="upi-id">${upiId}</span>
            <span class="upi-index">${index + 1}</span>
          </div>
        `;
        option.onclick = () => {
          copyUPI(upiId, platformName);
          closeUPIOverlay();
        };
        options.appendChild(option);
      });

      overlay.style.display = 'flex';
    }

    // Close UPI overlay
    function closeUPIOverlay() {
      document.getElementById('upiOverlay').style.display = 'none';
    }

    // Close overlay when clicking outside
    document.getElementById('upiOverlay').addEventListener('click', function (e) {
      if (e.target === this) {
        closeUPIOverlay();
      }
    });

    // Show phone overlay for multiple numbers
    function showPhoneOverlay(phoneNumbersString, platformName) {
      const phoneNumbers = phoneNumbersString.split('|').map(num => num.trim()).filter(num => num);
      const overlay = document.getElementById('phoneOverlay');
      const title = document.getElementById('phoneOverlayTitle');
      const options = document.getElementById('phoneOptions');

      title.textContent = `Select ${platformName} Number`;
      options.innerHTML = '';

      phoneNumbers.forEach((phoneNumber, index) => {
        const option = document.createElement('div');
        option.className = 'upi-option';
        option.innerHTML = `
          <div class="upi-option-content">
            <span class="upi-id">${phoneNumber}</span>
            <span class="upi-index">${index + 1}</span>
          </div>
        `;
        option.onclick = () => {
          window.location.href = `tel:${phoneNumber}`;
          closePhoneOverlay();
        };
        options.appendChild(option);
      });

      overlay.style.display = 'flex';
    }

    // Close phone overlay
    function closePhoneOverlay() {
      document.getElementById('phoneOverlay').style.display = 'none';
    }

    // Close phone overlay when clicking outside
    document.getElementById('phoneOverlay').addEventListener('click', function (e) {
      if (e.target === this) {
        closePhoneOverlay();
      }
    });

    // Show email overlay for multiple addresses
    function showEmailOverlay(emailAddressesString, platformName) {
      const emailAddresses = emailAddressesString.split('|').map(email => email.trim()).filter(email => email);
      const overlay = document.getElementById('emailOverlay');
      const title = document.getElementById('emailOverlayTitle');
      const options = document.getElementById('emailOptions');

      title.textContent = `Select ${platformName} Address`;
      options.innerHTML = '';

      emailAddresses.forEach((emailAddress, index) => {
        const option = document.createElement('div');
        option.className = 'upi-option';
        option.innerHTML = `
          <div class="upi-option-content">
            <span class="upi-id">${emailAddress}</span>
            <span class="upi-index">${index + 1}</span>
          </div>
        `;
        option.onclick = () => {
          window.location.href = `mailto:${emailAddress}`;
          closeEmailOverlay();
        };
        options.appendChild(option);
      });

      overlay.style.display = 'flex';
    }

    // Close email overlay
    function closeEmailOverlay() {
      document.getElementById('emailOverlay').style.display = 'none';
    }

    // Close email overlay when clicking outside
    document.getElementById('emailOverlay').addEventListener('click', function (e) {
      if (e.target === this) {
        closeEmailOverlay();
      }
    });

    // Show Google Maps overlay for multiple options
    function showGmapsOverlay(gmapsOptionsString, platformName) {
      const gmapsOptions = gmapsOptionsString.split('|').map(option => option.trim()).filter(option => option);
      const overlay = document.getElementById('gmapsOverlay');
      const title = document.getElementById('gmapsOverlayTitle');
      const options = document.getElementById('gmapsOptions');

      title.textContent = `Select ${platformName} Option`;
      options.innerHTML = '';

      gmapsOptions.forEach((option, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'upi-option';

        // Extract URL and label from the option string
        const urlMatch = option.match(/https?:\/\/[^\s]+/);
        const url = urlMatch ? urlMatch[0] : '';
        let label = option.replace(/https?:\/\/[^\s]+/, '').replace(/^[^:]+:\s*/, '');

        // Add specific labels based on the option type
        if (option.includes('Location:')) {
          label = 'Location';
        } else if (option.includes('Google Review:')) {
          label = 'Google Review';
        }

        optionElement.innerHTML = `
          <div class="upi-option-content">
            <span class="upi-id">${label}</span>
            <span class="upi-index">${index + 1}</span>
          </div>
        `;
        optionElement.onclick = () => {
          if (url) {
            window.open(url, '_blank', 'noopener');
          }
          closeGmapsOverlay();
        };
        options.appendChild(optionElement);
      });

      overlay.style.display = 'flex';
    }

    // Close Google Maps overlay
    function closeGmapsOverlay() {
      document.getElementById('gmapsOverlay').style.display = 'none';
    }

    // Close Google Maps overlay when clicking outside
    document.getElementById('gmapsOverlay').addEventListener('click', function (e) {
      if (e.target === this) {
        closeGmapsOverlay();
      }
    });

    // Show WhatsApp overlay for multiple numbers
    function showWhatsAppOverlay(whatsappUrlsString, platformName) {
      const whatsappUrls = whatsappUrlsString.split('|').map(url => url.trim()).filter(url => url);
      const overlay = document.getElementById('whatsappOverlay');
      const title = document.getElementById('whatsappOverlayTitle');
      const options = document.getElementById('whatsappOptions');

      title.textContent = `Select ${platformName} Number`;
      options.innerHTML = '';

      whatsappUrls.forEach((whatsappUrl, index) => {
        const option = document.createElement('div');
        option.className = 'upi-option';

        let displayText;

        // Check if it's a channel link
        if (whatsappUrl.includes('whatsapp.com/channel')) {
          // For channel links, display the clean URL without https:// and without "+" prefix
          // displayText = whatsappUrl.replace(/https?:\/\//gi, ''); // or just show as "WhatsApp Channel"
          displayText = 'WhatsApp Channel';
        }
        else if (whatsappUrl.includes('chat.whatsapp.com')) {
          // For channel links, display the clean URL without https:// and without "+" prefix
          // displayText = whatsappUrl.replace(/https?:\/\//gi, ''); // or just show as "WhatsApp Group"
          displayText = 'WhatsApp Group';
        }
        else {
          // Extract phone number from wa.me URL for display
          displayText = whatsappUrl.replace(/https?:\/\//gi, '').replace(/wa\.me\//gi, '').replace(/api\.whatsapp\.com\/send\?phone=/gi, '').split(/[?&]/)[0];
          // Add + prefix if not already present (for phone numbers only)
          if (!displayText.startsWith('+')) {
            displayText = '+' + displayText;
          }
        }

        option.innerHTML = `
          <div class="upi-option-content">
            <span class="upi-id">${displayText}</span>
            <span class="upi-index">${index + 1}</span>
          </div>
        `;
        option.onclick = () => {
          window.open(whatsappUrl, '_blank', 'noopener');
          closeWhatsAppOverlay();
        };
        options.appendChild(option);
      });

      overlay.style.display = 'flex';
    }

    // Close WhatsApp overlay
    function closeWhatsAppOverlay() {
      document.getElementById('whatsappOverlay').style.display = 'none';
    }

    // Close WhatsApp overlay when clicking outside
    document.getElementById('whatsappOverlay').addEventListener('click', function (e) {
      if (e.target === this) {
        closeWhatsAppOverlay();
      }
    });

    // Function to show QR code overlay
    function showUserQRCode() {
      const params = new URLSearchParams(window.location.search);
      const username = params.get('u');
      const userCode = params.get('code');

      if (!username || !userCode) {
        alert('Error: Unable to generate QR code. Missing parameters.');
        return;
      }

      // Create the same URL that's shown to the user
      const qrUrl = window.location.href;

      const qrContainer = document.getElementById('qrCodeContainer');
      qrContainer.innerHTML = '';

      // Generate QR Code using qrcode-generator library
      const typeNumber = 0;
      const errorCorrectionLevel = 'H';
      const qr = qrcode(typeNumber, errorCorrectionLevel);
      qr.addData(qrUrl);
      qr.make();

      // Create as image for better quality
      const size = 6;
      qrContainer.innerHTML = qr.createImgTag(size, 8);

      // Show overlay
      document.getElementById('qrCodeOverlay').style.display = 'flex';
    }

    // Function to close QR code overlay
    function closeQRCodeOverlay() {
      document.getElementById('qrCodeOverlay').style.display = 'none';
    }

    // Close QR code overlay when clicking outside
    document.getElementById('qrCodeOverlay').addEventListener('click', function (e) {
      if (e.target === this) {
        closeQRCodeOverlay();
      }
    });

    loadUser();
  </script>
</body>

</html>